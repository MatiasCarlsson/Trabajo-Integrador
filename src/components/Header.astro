---
import bloomLogo from '/public/img/bloom_logo.jpg';
import CarritoCompra from './icons/CarritoCompra.astro';
import '@styles/menuToggle.css';

// Helper para crear URLs con base path
const baseURL = import.meta.env.BASE_URL || '/';
const createURL = (path: string) => `${baseURL}${path.startsWith('/') ? path.slice(1) : path}`;
---

<header
  class="[background: linear-gradient( 360deg, rgba(240, 236, 229, 1) 0%, rgb(191, 164, 192, 1) 100% );] sticky top-0 z-10 w-full shadow-md backdrop-blur-lg"
>
  <!-- Contenedor principal del header -->
  <div class="flex items-center justify-between p-4">
    <!-- Logo -->
    <div class="flex flex-shrink-0 items-center">
      <a href={createURL('/')} class="flex items-center">
        <img
          src={bloomLogo.src}
          alt="Logo Bloom"
          width="48"
          height="48"
          class="size-10 rounded-full border-2 border-bloom-deep"
        />
      </a>
    </div>

    <!-- Buscador -->
    <form class="mx-5 flex flex-1 items-center">
      <label for="search" class="sr-only">Buscar productos</label>
      <input
        type="text"
        id="search"
        placeholder="Buscar productos..."
        class="text-md w-full rounded-md border border-gray-400 px-3 py-2 focus:border-bloom-deep focus:outline-none focus:ring-1 focus:ring-bloom-accent md:text-base"
      />
    </form>

    <!-- Navegación desktop -->
    <nav
      class="hidden justify-center p-1 sm:flex sm:items-center sm:gap-4 md:gap-8"
    >
      <a
        href={createURL('/')}
        class="whitespace-nowrap text-sm font-medium transition-colors hover:rounded-lg hover:bg-bloom-accent hover:shadow-md sm:text-sm lg:text-lg"
      >
        Inicio
      </a>
      <a
        href={createURL('/productos')}
        class="whitespace-nowrap text-sm font-medium transition-colors hover:rounded-lg hover:bg-bloom-accent hover:shadow-md sm:text-sm lg:text-lg"
      >
        Productos
      </a>
      <a
        href={createURL('/acercaDeNosotros')}
        class="whitespace-nowrap text-sm font-medium transition-colors hover:rounded-lg hover:bg-bloom-accent hover:shadow-md sm:text-sm lg:text-lg"
      >
        Acerca de nosotros
      </a>
    </nav>

    <!-- Contenedor de botones (menú + carrito) -->
    <div class="flex items-center gap-2">
      <!-- Botón menú móvil -->
      <label
        id="menu-toggle"
        class="menu-toggle-label flex size-8 cursor-pointer items-center justify-center rounded-md transition-colors hover:bg-white/20 sm:hidden"
        aria-label="Abrir menú"
      >
        <input type="checkbox" id="menu-checkbox" />
        <svg viewBox="0 0 32 32" class="size-6">
          <path
            class="line line-top-bottom"
            d="M27 10 13 10C10.8 10 9 8.2 9 6 9 3.5 10.8 2 13 2 15.2 2 17 3.8 17 6L17 26C17 28.2 18.8 30 21 30 23.2 30 25 28.2 25 26 25 23.8 23.2 22 21 22L7 22"
          ></path>
          <path class="line" d="M7 16 27 16"></path>
        </svg>
      </label>

      <!-- Carrito -->
      <a
        href={createURL('/carrito')}
        class="flex size-8 items-center justify-center rounded-lg transition-colors hover:bg-white/20 sm:size-10"
        aria-label="Ver carrito"
      >
        <CarritoCompra />
      </a>
    </div>
  </div>

  <!-- Menú móvil - FUERA del flex principal -->
  <nav
    id="mobile-menu"
    class="hidden w-full border-t border-white/20 bg-white/10 backdrop-blur-lg sm:hidden"
  >
    <div class="px-4 py-2">
      <a
        href={createURL('/')}
        class="block rounded-md px-3 py-2 text-sm font-medium transition-colors hover:bg-bloom-accent"
      >
        Inicio
      </a>
      <a
        href={createURL('/productos')}
        class="block rounded-md px-3 py-2 text-sm font-medium transition-colors hover:bg-bloom-accent"
      >
        Productos
      </a>
      <a
        href={createURL('/acercaDeNosotros')}
        class="block rounded-md px-3 py-2 text-sm font-medium transition-colors hover:bg-bloom-accent"
      >
        Acerca de nosotros
      </a>
      <a
        href={createURL('/carrito')}
        class="block rounded-md px-3 py-2 text-sm font-medium transition-colors hover:bg-bloom-accent"
      >
        Carrito
      </a>
    </div>
  </nav>
</header>

<script src="/src/scripts/menuToggle.js" type="text/javascript"></script>
